<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LargeSVM: bsgd.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="largeSVM.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">LargeSVM
   </div>
   <div id="projectbrief">Library for Large-Scale Multi-Class Problems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c1711ee76361e7ab6ea2b63d5963a3ee.html">Large-scale library</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bsgd.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of BSGD algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;vector&gt;</code><br/>
<code>#include &lt;sstream&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;cmath&gt;</code><br/>
<code>#include &lt;algorithm&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="large_s_v_m_8h_source.html">largeSVM.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="bsgd_8h_source.html">bsgd.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af483789b9ee27204089871e24cf1d082"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bsgd_8cpp.html#af483789b9ee27204089871e24cf1d082">evalFunc</a> (long double a1, long double a2, long double k12, long double x)</td></tr>
<tr class="memdesc:af483789b9ee27204089871e24cf1d082"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the current value of merging objective function.  <a href="#af483789b9ee27204089871e24cf1d082"></a><br/></td></tr>
<tr class="separator:af483789b9ee27204089871e24cf1d082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea33e6b2c409573e496bc5c7fcfe8563"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bsgd_8cpp.html#aea33e6b2c409573e496bc5c7fcfe8563">goldenSectionSearch</a> (long double k12, long double a1, long double a2, long double a, long double b, long double tolerance)</td></tr>
<tr class="memdesc:aea33e6b2c409573e496bc5c7fcfe8563"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the parameter k that specifies the position of the merged data point (merged = k * point1 + (1 - k) * point2).  <a href="#aea33e6b2c409573e496bc5c7fcfe8563"></a><br/></td></tr>
<tr class="separator:aea33e6b2c409573e496bc5c7fcfe8563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae385b07b4417741fe8f576b07cf2a2d1"><td class="memItemLeft" align="right" valign="top">long double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bsgd_8cpp.html#ae385b07b4417741fe8f576b07cf2a2d1">computeKmax</a> (vector&lt; <a class="el" href="classlarge_vector_b_s_g_d.html">largeVectorBSGD</a> * &gt; *v, unsigned int merge1, <a class="el" href="structparameters.html">parameters</a> *param)</td></tr>
<tr class="memdesc:ae385b07b4417741fe8f576b07cf2a2d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find which two vectors to merge.  <a href="#ae385b07b4417741fe8f576b07cf2a2d1"></a><br/></td></tr>
<tr class="separator:ae385b07b4417741fe8f576b07cf2a2d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5779a5ce89e3e3840cd49008784ee274"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bsgd_8cpp.html#a5779a5ce89e3e3840cd49008784ee274">predictBSGD</a> (<a class="el" href="classlarge_data.html">largeData</a> *testData, <a class="el" href="structparameters.html">parameters</a> *param, <a class="el" href="classlarge_model_b_s_g_d.html">largeModelBSGD</a> *model, vector&lt; char &gt; *labels)</td></tr>
<tr class="memdesc:a5779a5ce89e3e3840cd49008784ee274"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a BSGD model, predict the labels of testing data.  <a href="#a5779a5ce89e3e3840cd49008784ee274"></a><br/></td></tr>
<tr class="separator:a5779a5ce89e3e3840cd49008784ee274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69cc277d68cebf45e711dee01a6eeeab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bsgd_8cpp.html#a69cc277d68cebf45e711dee01a6eeeab">trainBSGD</a> (<a class="el" href="classlarge_data.html">largeData</a> *trainData, <a class="el" href="structparameters.html">parameters</a> *param, <a class="el" href="classlarge_model_b_s_g_d.html">largeModelBSGD</a> *model)</td></tr>
<tr class="memdesc:a69cc277d68cebf45e711dee01a6eeeab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Train BSGD.  <a href="#a69cc277d68cebf45e711dee01a6eeeab"></a><br/></td></tr>
<tr class="separator:a69cc277d68cebf45e711dee01a6eeeab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of BSGD algorithm. </p>
<p>Implements the functions used to train and test the Budgeted Stochastic Gradient Descent (BSGD) model. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae385b07b4417741fe8f576b07cf2a2d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double * computeKmax </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classlarge_vector_b_s_g_d.html">largeVectorBSGD</a> * &gt; *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>merge1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparameters.html">parameters</a> *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find which two vectors to merge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Support vector set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">merge1</td><td>Index of the support vector that is being merged. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>The parameters of the algorithm. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An array: 1) k that maximizes merging objective function; 2) kernel value between first point and the merged point; 3) kernel value between second point and the merged point; 4) index of the second support vector to be merged.</dd></dl>
<p>Used during the merging strategy of the budget maintenance process. Given an existing support vector, finds which other support vector to merge with it to incur the smallest degradation of the model due to the merging loss. </p>

</div>
</div>
<a class="anchor" id="af483789b9ee27204089871e24cf1d082"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double evalFunc </td>
          <td>(</td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>k12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the current value of merging objective function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a1</td><td>Alpha (class-specific) value of the first point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a2</td><td>Alpha (class-specific) value of the second point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k12</td><td>Kernel value between two points that are being merged. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Current value of merging parameter h. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of merging objective function.</dd></dl>
<p>Evaluates the value of the merging objective function during the merging strategy of the budget maintenance process. Used by <a class="el" href="bsgd_8cpp.html#aea33e6b2c409573e496bc5c7fcfe8563">goldenSectionSearch</a> function. </p>

</div>
</div>
<a class="anchor" id="aea33e6b2c409573e496bc5c7fcfe8563"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double goldenSectionSearch </td>
          <td>(</td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>k12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long double&#160;</td>
          <td class="paramname"><em>tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the parameter k that specifies the position of the merged data point (merged = k * point1 + (1 - k) * point2). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">k12</td><td>Kernel value between two points that are being merged. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a1</td><td>Alpha (class-specific) value of the first point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a2</td><td>Alpha (class-specific) value of the second point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Lower bound on the interval where we seek the solution. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Upper bound on the interval where we seek the solution. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tolerance</td><td>Tolerance of the solution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of parameter k.</dd></dl>
<p>Used during the merging strategy of the budget maintenance process. Uses efficient golden search optimization to find value of k that minimizes the merging objective function. Used by <a class="el" href="bsgd_8cpp.html#ae385b07b4417741fe8f576b07cf2a2d1">computeKmax</a> function. </p>

</div>
</div>
<a class="anchor" id="a5779a5ce89e3e3840cd49008784ee274"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float predictBSGD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlarge_data.html">largeData</a> *&#160;</td>
          <td class="paramname"><em>testData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparameters.html">parameters</a> *&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlarge_model_b_s_g_d.html">largeModelBSGD</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; char &gt; *&#160;</td>
          <td class="paramname"><em>labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a BSGD model, predict the labels of testing data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">testData</td><td>Input test data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>The parameters of the algorithm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>Trained BSGD model. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">labels</td><td>Vector of predicted labels. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error rate.</dd></dl>
<p>Given the learned BSGD model, the function computes the predictions on the testing data, outputing the predicted labels and the error rate. </p>

</div>
</div>
<a class="anchor" id="a69cc277d68cebf45e711dee01a6eeeab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trainBSGD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlarge_data.html">largeData</a> *&#160;</td>
          <td class="paramname"><em>trainData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparameters.html">parameters</a> *&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlarge_model_b_s_g_d.html">largeModelBSGD</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Train BSGD. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">trainData</td><td>Input training data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param</td><td>The parameters of the algorithm. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model</td><td>Initial BSGD model.</td></tr>
  </table>
  </dd>
</dl>
<p>The function trains BSGD model, given input data, the initial model (most often zero-weight model), and the parameters of the model. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Dec 11 2012 19:47:06 for LargeSVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
